<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  
  <!-- Titre de l'onglet -->
  <title>ÉZUKA - Transferts d'argent rapides</title>

  <!-- Favicon et icônes CORRIGÉES -->
  <link rel="icon" type="image/png" href="/static/logo.png">
  <link rel="shortcut icon" href="/static/logo.png">
  <link rel="apple-touch-icon" href="/static/logo.png">
  
  <!-- Manifest -->
  <link rel="manifest" href="/static/manifest.json">
  <meta name="theme-color" content="#082630">

  <!-- Open Graph / Facebook - CORRIGÉ avec votre domaine -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.ezuka.net/" />
  <meta property="og:title" content="ÉZUKA - Transferts d'argent rapides" />
  <meta property="og:description" content="Faites vos transferts d'argent facilement et en toute sécurité avec ÉZUKA." />
  <meta property="og:image" content="https://www.ezuka.net/static/logo.png" />
  <meta property="og:image:width" content="512" />
  <meta property="og:image:height" content="512" />

  <!-- Twitter - CORRIGÉ -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content="https://www.ezuka.net/" />
  <meta name="twitter:title" content="ÉZUKA - Transferts d'argent rapides" />
  <meta name="twitter:description" content="Faites vos transferts d'argent facilement et en toute sécurité avec ÉZUKA." />
  <meta name="twitter:image" content="https://www.ezuka.net/static/logo.png" />

  <!-- Police -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap" rel="stylesheet">
  <meta name="twitter:image" content="https://i.postimg.cc/bw4C62zX/logo.png" />
  <title>Payments Bank</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f6fa;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    header {
      background: #0c2137;
      width: 100%;
      color: white;
      padding: 15px;
      text-align: center;
    }
    .balance-section {
      background: white;
      margin-top: 20px;
      padding: 20px;
      width: 350px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      text-align: center;
    }
    .balance-amount {
      font-size: 24px;
      font-weight: bold;
      color: #0c2137;
      margin: 10px 0;
    }
    .menu-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-top: 20px;
      width: 350px;
    }
    .menu-item {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      text-align: center;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .menu-item:hover {
      transform: translateY(-2px);
      background: #f8f9fa;
    }
    .menu-icon {
      font-size: 24px;
      margin-bottom: 8px;
      color: #0c2137;
    }
    .icon-svg {
      width: 24px;
      height: 24px;
      margin-bottom: 8px;
      fill: #0c2137;
    }
    .menu-label {
      font-size: 12px;
      color: #333;
    }
    .transactions-section {
      background: white;
      margin-top: 30px;
      padding: 20px;
      width: 350px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .transaction-item {
      padding: 15px 0;
      border-bottom: 1px solid #eee;
      position: relative;
    }
    .transaction-item:last-child {
      border-bottom: none;
    }
    .transaction-amount {
      font-weight: bold;
      position: absolute;
      right: 0;
      top: 15px;
    }
    .negative {
      color: #e74c3c;
    }
    .positive {
      color: #2ecc71;
    }
    .transaction-date {
      color: #666;
      font-size: 12px;
      margin-top: 5px;
    }
    .transaction-detail {
      color: #333;
      font-size: 14px;
      font-weight: 500;
    }
    .user-info {
      background: white;
      margin-top: 20px;
      padding: 15px;
      width: 350px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      text-align: center;
    }
    .section-title {
      color: #0c2137;
      margin-bottom: 15px;
      font-size: 16px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <h1>E$uka Bank</h1>
  </header>

  <div class="user-info">
    <div>Bienvenue, <strong id="userName">Chargement...</strong></div>
    <div><small>Pays: <span id="userCountry">Chargement...</span></small></div>
  </div>

  <div class="balance-section">
    <div>Solde</div>
    <div class="balance-amount" id="balanceAmount">Chargement...</div>
    <div>Disponible</div>
  </div>

  <div class="menu-grid">
    <div class="menu-item" onclick="navigateTo('send')">
      <div class="menu-icon">
        <!-- SVG Send Icon -->
        <svg class="icon-svg" viewBox="0 0 24 24">
          <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
        </svg>
      </div>
      <div class="menu-label">Send</div>
    </div>
    <div class="menu-item" onclick="navigateTo('depot')">
      <div class="menu-icon">
        <!-- SVG Deposit Icon -->
        <svg class="icon-svg" viewBox="0 0 24 24">
          <path d="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm13-6v11c0 1.1-.9 2-2 2H4v-2h17V7h2z"/>
        </svg>
      </div>
      <div class="menu-label">Depot</div>
    </div>
    <div class="menu-item" onclick="navigateTo('rewards')">
      <div class="menu-icon">
        <!-- SVG Gift Icon -->
        <svg class="icon-svg" viewBox="0 0 24 24">
          <path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"/>
        </svg>
      </div>
      <div class="menu-label">Rewards</div>
    </div>
    <div class="menu-item" onclick="navigateTo('setting')">
  <div class="menu-icon">
    <!-- SVG Setting Icon -->
    <svg class="icon-svg" viewBox="0 0 24 24">
      <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
    </svg>
  </div>
  <div class="menu-label">Setting</div>
</div>
    <div class="menu-item" onclick="navigateTo('withdraw')">
  <div class="menu-icon">
    <!-- SVG Withdraw Icon -->
    <svg class="icon-svg" viewBox="0 0 24 24">
      <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-6h2v6zm4 0h-2v-6h2v6zm-6-8V7h6v2H9z"/>
    </svg>
  </div>
  <div class="menu-label">Withdraw</div>
</div>
    <div class="menu-item" onclick="logout()">
      <div class="menu-icon">
        <!-- SVG Logout Icon -->
        <svg class="icon-svg" viewBox="0 0 24 24">
          <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
        </svg>
      </div>
      <div class="menu-label">Logout</div>
    </div>
  </div>

 <div class="transactions-section">
  <button id="showHistory" class="section-title" style="background:#1e3a8a;color:white;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;text-align: center;margin-left: 70px;">
    Dernières transactions
  </button>

  <div id="historyContainer" style="display:none;margin-top:15px;">
    <table border="1" width="90%" cellspacing="0" cellpadding="5" style="border-collapse:collapse;text-align:center;margin-left: -20px;">
      <thead>
        <tr style="background:#0f172a;color:white;">
          <th>Type</th>
          <th>Montant</th>
          <th>Devise</th>
          <th>Statut</th>
          <th>Date</th>
          <th>Note</th>
        </tr>
      </thead>
      <tbody id="historyTable">
        <tr><td colspan="4">Aucune transaction</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
document.getElementById("showHistory").addEventListener("click", () => {
  const container = document.getElementById("historyContainer");
  const isHidden = container.style.display === "none";
  container.style.display = isHidden ? "block" : "none";
  if (isHidden) loadHistory();
});

async function loadHistory() {
  const table = document.getElementById("historyTable");
  table.innerHTML = "<tr><td colspan='6'>Chargement...</td></tr>";

  try {
    const res = await fetch("/api/history");
    const data = await res.json();

    if (!Array.isArray(data) || data.length === 0) {
      table.innerHTML = "<tr><td colspan='6'>Aucune transaction trouvée</td></tr>";
      return;
    }

    table.innerHTML = "";
    data.forEach(tx => {
      let color = "#f97316"; // orange (en cours)
      if (tx.status === "approved" || tx.status === "completed") color = "#22c55e"; // vert
      if (tx.status === "rejected") color = "#ef4444"; // rouge

      const row = `
        <tr>
          <td>${tx.type}</td>
          <td>${tx.amount}</td>
          <td>${tx.currency}</td>
          <td style="color:${color};font-weight:bold;">${tx.status}</td>
          <td>${tx.date}</td>
          <td>${tx.note}</td>
        </tr>`;
      table.innerHTML += row;
    });
  } catch (err) {
    console.error(err);
    table.innerHTML = "<tr><td colspan='6'>Erreur de chargement</td></tr>";
  }
}
</script>

<script>
function navigateTo(page) {
    // Exemple simple : charger le template correspondant
    if (page === 'depot') {
        window.location.href = '/depot'; // URL Flask qui sert la page dépôt
    }
    // tu peux ajouter d'autres pages
    else if (page === 'send') {
        window.location.href = '/send';
    } 
    else if (page === 'historique') {
        window.location.href = '/historique';
    }

      else if (page === 'withdraw') {
        window.location.href = '/withdraw';
    }

       else if (page === 'setting') {
        window.location.href = '/seting';
    }
       else if (page === 'rewards') {
        window.location.href = '/rewards';
    }
}
</script>
  <script>
  // Fonction de navigation
  function navigateTo(page) {
    window.location.href = `/${page}`;
  }

  // Fonction de déconnexion
  function logout() {
    window.location.href = '/logout';
  }

  // Récupère les infos utilisateur depuis ton API Flask
  async function loadUserInfo() {
    try {
      const res = await fetch("/api/user_info");
      const data = await res.json();

      if (!data.ok) {
        console.error("Erreur:", data.error || "Utilisateur non connecté");
        return;
      }

      const user = data.user;

      // Affichage des infos de l'utilisateur
      document.getElementById("userName").textContent = `${user.first_name} ${user.last_name}`;
      document.getElementById("userCountry").textContent = user.country;
      document.getElementById("balanceAmount").textContent = `${user.balance.toFixed(2)} ${user.currency}`;

      // Affiche les transactions s’il y en a
      if (data.transactions && Array.isArray(data.transactions)) {
        displayTransactions(data.transactions);
      }
    } catch (err) {
      console.error("Erreur lors de la récupération des infos :", err);
    }
  }

  // Affichage des transactions récentes
  function displayTransactions(transactions) {
    const table = document.getElementById("historyTable");
    table.innerHTML = "";

    if (transactions.length === 0) {
      table.innerHTML = "<tr><td colspan='6'>Aucune transaction récente</td></tr>";
      return;
    }

    transactions.forEach(tx => {
      let color = "#f97316"; // orange = en attente
      if (tx.status === "approved" || tx.status === "completed") color = "#22c55e"; // vert
      if (tx.status === "rejected") color = "#ef4444"; // rouge

      const row = `
        <tr>
          <td>${tx.type}</td>
          <td>${tx.amount}</td>
          <td>${tx.currency}</td>
          <td style="color:${color};font-weight:bold;">${tx.status}</td>
          <td>${tx.date}</td>
          <td>${tx.note}</td>
        </tr>`;
      table.innerHTML += row;
    });
  }

  // Charger automatiquement les infos utilisateur au démarrage
  loadUserInfo();
</script>

</body>
</html>