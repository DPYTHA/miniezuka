<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Frais et Taux - Miniezuka</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f6fa; color: #2c3e50; }
        .admin-container { display: flex; min-height: 100vh; }
        
        /* Sidebar */
        .sidebar { width: 250px; background: #2c3e50; color: white; padding: 20px 0; position: fixed; height: 100vh; }
        .logo { text-align: center; padding: 20px; border-bottom: 1px solid #34495e; margin-bottom: 20px; }
        .logo h1 { font-size: 24px; font-weight: 600; }
        .nav-menu { list-style: none; }
        .nav-item { padding: 15px 25px; cursor: pointer; transition: background 0.3s; border-left: 4px solid transparent; }
        .nav-item:hover, .nav-item.active { background: #34495e; border-left-color: #3498db; }
        
        /* Main Content */
        .main-content { flex: 1; margin-left: 250px; padding: 20px; }
        .header { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        
        /* Tabs */
        .tabs { display: flex; border-bottom: 1px solid #ecf0f1; margin-bottom: 20px; }
        .tab { padding: 15px 25px; cursor: pointer; border-bottom: 3px solid transparent; }
        .tab.active { border-bottom-color: #3498db; color: #3498db; font-weight: 600; }
        
        /* Tables */
        .section { background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; overflow: hidden; }
        .section-header { padding: 20px; border-bottom: 1px solid #ecf0f1; display: flex; justify-content: space-between; align-items: center; }
        .section-content { padding: 20px; }
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #ecf0f1; }
        th { background: #f8f9fa; font-weight: 600; }
        tr:hover { background: #f8f9fa; }
        
        /* Forms */
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; }
        .form-control { width: 100%; padding: 10px; border: 2px solid #e1e1e1; border-radius: 5px; font-size: 14px; }
        .form-control:focus { outline: none; border-color: #3498db; }
        .btn { padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; transition: background 0.3s; }
        .btn-primary { background: #3498db; color: white; }
        .btn-success { background: #27ae60; color: white; }
        .btn-danger { background: #e74c3c; color: white; }
        .btn:hover { opacity: 0.9; }
        
        /* Status */
        .status-active { color: #27ae60; font-weight: 600; }
        .status-inactive { color: #e74c3c; font-weight: 600; }
        
        /* Actions */
        .actions { display: flex; gap: 5px; }
        .action-btn { padding: 5px 10px; border: none; border-radius: 3px; cursor: pointer; font-size: 12px; }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            color: #2c3e50;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #7f8c8d;
        }

        .close-modal:hover {
            color: #e74c3c;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #ecf0f1;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h1>Miniezuka Admin</h1>
            </div>
            <ul class="nav-menu">
                <li class="nav-item" data-tab="fees">Frais par Devise</li>
                <li class="nav-item" data-tab="rates">Taux de Change</li>
                <li class="nav-item" data-tab="countries">Pays & Devises</li>
                <li class="nav-item" onclick="window.location.href='/admin/advanced'">← Retour Dashboard</li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h1>Gestion des Frais et Taux de Change</h1>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <div class="tab active" data-tab="fees">Frais par Devise</div>
                <div class="tab" data-tab="rates">Taux de Change</div>
                <div class="tab" data-tab="countries">Pays & Devises</div>
            </div>

            <!-- Frais par Devise Tab -->
            <div id="fees-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <h2>Configuration des Frais par Devise</h2>
                        <button class="btn btn-primary" onclick="showAddCurrencyForm()">+ Ajouter une Devise</button>
                    </div>
                    <div class="section-content">
                        <div class="table-container">
                            <table id="currency-fees-table">
                                <thead>
                                    <tr>
                                        <th>Devise</th>
                                        <th>Nom</th>
                                        <th>Frais Transfert (%)</th>
                                        <th>Frais Retrait (%)</th>
                                        <th>Statut</th>
                                        <th>Dernière MAJ</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="currency-fees-body">
                                    <!-- Les données seront chargées ici -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Taux de Change Tab -->
            <div id="rates-tab" class="tab-content" style="display: none;">
                <div class="section">
                    <div class="section-header">
                        <h2>Gestion des Taux de Change</h2>
                        <button class="btn btn-primary" onclick="showAddRateForm()">+ Ajouter un Taux</button>
                    </div>
                    <div class="section-content">
                        <div class="table-container">
                            <table id="exchange-rates-table">
                                <thead>
                                    <tr>
                                        <th>De</th>
                                        <th>Vers</th>
                                        <th>Taux</th>
                                        <th>Statut</th>
                                        <th>Dernière MAJ</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="exchange-rates-body">
                                    <!-- Les données seront chargées ici -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pays & Devises Tab -->
            <div id="countries-tab" class="tab-content" style="display: none;">
                <div class="section">
                    <div class="section-header">
                        <h2>Association Pays - Devise</h2>
                    </div>
                    <div class="section-content">
                        <div class="table-container">
                            <table id="countries-table">
                                <thead>
                                    <tr>
                                        <th>Pays</th>
                                        <th>Code</th>
                                        <th>Devise</th>
                                        <th>Statut</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="countries-body">
                                    <!-- Les données seront chargées ici -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal pour modifier les devises -->
    <div id="editCurrencyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Modifier la Devise</h3>
                <button class="close-modal" onclick="closeModal('editCurrencyModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editCurrencyForm">
                    <input type="hidden" id="editCurrencyId">
                    <div class="form-group">
                        <label>Code Devise *</label>
                        <input type="text" id="editCurrencyCode" class="form-control" required readonly>
                    </div>
                    <div class="form-group">
                        <label>Nom de la Devise *</label>
                        <input type="text" id="editCurrencyName" class="form-control" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Frais Transfert (%) *</label>
                            <input type="number" id="editTransferFee" class="form-control" step="0.1" min="0" max="50" required>
                        </div>
                        <div class="form-group">
                            <label>Frais Retrait (%) *</label>
                            <input type="number" id="editWithdrawalFee" class="form-control" step="0.1" min="0" max="50" required>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="editCurrencyActive">
                        <label for="editCurrencyActive">Devise active</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeModal('editCurrencyModal')">Annuler</button>
                <button class="btn btn-primary" onclick="saveCurrencyConfig()">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- Modal pour modifier les taux de change -->
    <div id="editRateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Modifier le Taux de Change</h3>
                <button class="close-modal" onclick="closeModal('editRateModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editRateForm">
                    <input type="hidden" id="editRateId">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Devise Source *</label>
                            <input type="text" id="editFromCurrency" class="form-control" required readonly>
                        </div>
                        <div class="form-group">
                            <label>Devise Cible *</label>
                            <input type="text" id="editToCurrency" class="form-control" required readonly>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Taux de Change *</label>
                        <input type="number" id="editExchangeRate" class="form-control" step="0.0001" min="0" required>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="editRateActive">
                        <label for="editRateActive">Taux actif</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeModal('editRateModal')">Annuler</button>
                <button class="btn btn-primary" onclick="saveExchangeRate()">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- Modal pour modifier les pays -->
    <div id="editCountryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Modifier le Pays</h3>
                <button class="close-modal" onclick="closeModal('editCountryModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editCountryForm">
                    <input type="hidden" id="editCountryId">
                    <div class="form-group">
                        <label>Nom du Pays *</label>
                        <input type="text" id="editCountryName" class="form-control" required readonly>
                    </div>
                    <div class="form-group">
                        <label>Code Pays *</label>
                        <input type="text" id="editCountryCode" class="form-control" required readonly>
                    </div>
                    <div class="form-group">
                        <label>Devise *</label>
                        <select id="editCountryCurrency" class="form-control" required>
                            <option value="">Sélectionnez une devise</option>
                            <option value="XOF">XOF - Franc CFA</option>
                            <option value="XAF">XAF - Franc CFA</option>
                            <option value="GNF">GNF - Franc Guinéen</option>
                            <option value="RUB">RUB - Rouble Russe</option>
                            <option value="CAD">CAD - Dollar Canadien</option>
                            <option value="GHS">GHS - Cedi Ghanéen</option>
                            <option value="NGN">NGN - Naira Nigérian</option>
                            <option value="EUR">EUR - Euro</option>
                            <option value="USD">USD - Dollar US</option>
                        </select>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="editCountryActive">
                        <label for="editCountryActive">Pays actif</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeModal('editCountryModal')">Annuler</button>
                <button class="btn btn-primary" onclick="saveCountryCurrency()">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- Modal pour ajouter un taux de change -->
    <div id="addRateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ajouter un Taux de Change</h3>
                <button class="close-modal" onclick="closeModal('addRateModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addRateForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Devise Source *</label>
                            <select id="addFromCurrency" class="form-control" required>
                                <option value="">Sélectionnez</option>
                                <option value="XOF">XOF</option>
                                <option value="XAF">XAF</option>
                                <option value="GNF">GNF</option>
                                <option value="RUB">RUB</option>
                                <option value="CAD">CAD</option>
                                <option value="EUR">EUR</option>
                                <option value="USD">USD</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Devise Cible *</label>
                            <select id="addToCurrency" class="form-control" required>
                                <option value="">Sélectionnez</option>
                                <option value="XOF">XOF</option>
                                <option value="XAF">XAF</option>
                                <option value="GNF">GNF</option>
                                <option value="RUB">RUB</option>
                                <option value="CAD">CAD</option>
                                <option value="EUR">EUR</option>
                                <option value="USD">USD</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Taux de Change *</label>
                        <input type="number" id="addExchangeRate" class="form-control" step="0.0001" min="0" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeModal('addRateModal')">Annuler</button>
                <button class="btn btn-primary" onclick="addNewExchangeRate()">Ajouter</button>
            </div>
        </div>
    </div>

    <script src="/static/fees_dashboard.js"></script>
</body>
</html>